# FAISS-Based Recommendation System

This repository contains a Python-based project that leverages FAISS (Facebook AI Similarity Search) to build a recommendation system for Netflix titles using textual embeddings generated by an external API. Below are the details of how the system works, the flow of code, and the technologies used.

---

## 1. **Working**
The project builds a recommendation system using the following steps:

1. Load a dataset of Netflix titles (stored in a CSV file).
2. Generate descriptive text representations for each title.
3. Send these text representations to an embedding API (e.g., Llama 3.2) to obtain high-dimensional embeddings.
4. Index these embeddings using FAISS to enable fast similarity searches.
5. Save the FAISS index for future use.

By querying the FAISS index with an embedding of a user-provided prompt, the system retrieves the most similar Netflix titles based on their embeddings.

---

## 2. **Flow of Code**

### **Step 1: Load Data**
- Read the `netflix_titles.csv` file using `pandas`.
- Add a new column, `text_format`, containing a formatted text representation of each row.

### **Step 2: FAISS Index Initialization**
- Define the dimensionality of the embeddings (`dim`), which must match the output of the embedding API.
- Initialize a FAISS index (`IndexFlatL2`) to store the embeddings.

### **Step 3: Embedding Generation**
- Iterate through each formatted text in the dataset.
- Send the text to the embedding API via a POST request.
- Validate and store the returned embeddings in a numpy array.

### **Step 4: Populate FAISS Index**
- Add the numpy array of embeddings to the FAISS index.

### **Step 5: Save the Index**
- Save the FAISS index to a binary file (`faiss_index.bin`) for later use.

---

## 3. **Technologies/Libraries/Dependencies Used**

### **Technologies**
- FAISS: For efficient similarity search and indexing of high-dimensional data.
- Flask: (in related scripts) For building APIs and serving recommendations.

### **Libraries**
- `pandas`: For data manipulation and handling CSV files.
- `faiss`: For indexing and similarity search.
- `requests`: For sending HTTP requests to the embedding API.
- `numpy`: For numerical operations and handling embeddings.
- `tqdm`: For displaying progress bars in the command-line interface.

### **Dependencies**
Ensure the following dependencies are installed:

```bash
pip install pandas faiss-cpu requests numpy tqdm
```

---

## Usage

1. **Prepare the Dataset:** Ensure `netflix_titles.csv` is available in the specified location.
2. **Run the Script:** Execute the script to generate embeddings and build the FAISS index.
3. **Query the FAISS Index:** Use the saved FAISS index in downstream applications for recommendations.

---

Feel free to contribute to the project by improving embedding generation, optimizing FAISS indexing, or enhancing the recommendation logic!
